<!doctype html>

<html>
<!--
 * Script que cria impressão.
 * contato: amauri_long@yahoo.com.br
 *
 * @author Amauri Bueno dos santos
 * @created 11/04/2011
 * @version 2.2, 11/04/2011
-->
<head>
<meta charset="utf-8">
<title>Click no testo e precione Esc</title>
<style type="text/css">
body {
	background-repeat: no-repeat;
	background-color: #99FF00;
}
pre {
    display: block;
    font-family: monospace;
    white-space: pre;
    margin: 1em 0;
} 
</style>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<head/>
<body background="welcome_journal.png" >
<script language="JavaScript" type="text/javascript">
<!--

setTimeout("loadOuter()", 0)

var srcFrame;
//External content into a layer
function loadOuter() {
 srcFrame = document.getElementById("hiddenContent");
 srcFrame.src = 'arquivo.txt';
 // workaround for missing onLoad event in IFRAME for NN6
 if (!srcFrame.onload) {
  setTimeout("transferHTML()", 0)
 }
}

function transferHTML(){
 srcContent='';
 if (srcFrame.contentDocument){
  srcContent=srcFrame.contentDocument.getElementsByTagName("BODY")[0].innerHTML;
 }
 else if (srcFrame.contentWindow){
  srcContent=srcFrame.contentWindow.document.body.innerHTML;
 }
 var str = srcContent;
 var res = str.split("<pre>");
 document.form1.p1.value = res;
}


var DocAry=new Array('arquivo.txt','arquivo.txt');

function SelectList(v){
 if (v>0){
  loadOuter(DocAry[v-1]);
 }
}
//-->
</script>
<iframe  id="hiddenContent" width="200" height="200" style="position:absolute;visibility:hidden;" ></iframe>

<script type="text/javascript" src="print.js"></script>


<form id="form1" name="form1" method="post" action="email.html">
  <label for="p1"></label>
  <table width="504" border="0">
    <tr>
      <td width="144" rowspan="3" bgcolor="#009999">&nbsp;</td>
      <td width="317" height="117" colspan="3"> IMPRESS&Atilde;O DE CUPOM PROCISA<br>
	  
      <br>
      <select id="tecnicoSelecionado" name="tecnicoSelecionado" class="form-control search-select" onchange="info();" size="1">	
	<option value="88071">HELEM DENIS RODRIGUES - BP</option>
	<option value="88072">JOSE ALBINO MENDES SILVA - BP</option>
	<option value="88074">RAFAEL RODRIGUES DA SILVA - BP</option>
	<option value="88075">RONALDO TOMAZOLI FERREIRA - BP</option>
	<option value="88076">ANTONIO CARLOS OLIVEIRA CARVALHO - BP</option>
	<option value="88077">EXODO SOARES CAVALCANTE - BP</option>
	<option value="88091">CESAR AUGUSTO DA SILVA PEREIRA - AT</option>
	<option value="88135">EDUARDO APA. DE OLIVEIRA PINTO - AT</option>
	<option value="88136">JORGE MARQUES DE GALES - AT</option>
	<option value="88137">ANDERSON DA SILVA CABRAL - AT</option>
	<option value="88138">WELLINGTON DO AMARAL - AT</option>
	<option value="88164">JEFFERSON LIZARTE DE FREITAS</option>
	<option value="88171">JOSE CARLOS BRONZO</option>
	<option value="88173">DANILO PAVAO BOREAN</option>
	<option value="88174">JOSE CRISTIANO DO SANTOS </option>
	<option value="88175">ANDRE ROCHA MOREIRA</option>
	<option value="88337">EDERSON PEREIRA CAVALHEIRO</option>
</select>
      <span style="color: #FFF">
      <input name="id" type="checkbox" class="campos_v" id="on" value="on" />
      </span>selecione senha 
      <input type="text" size ="1" width="1" maxlength="2" value="1" id="campo">
      <br>
      <input type="button" name="button" id="button" onClick="p();" value="Imprimir">
      <input type="button" name="button3" id="button3" onClick="negrito();" value="negrito">
	  <input type="button" name="button4" id="button4" onClick="normal();" value="normal">
	  <input type="button" name="button8" id="button8" onClick="vgraln();" value="90 on">
	  <input type="button" name="button5" id="button5" onClick="vgral();" value="90 off">
	  <input type="button" name="button11" id="button11" onClick="logonet();" value="NET">
	  </td>
      <td width="29" rowspan="3" bgcolor="#009999">&nbsp;</td>
    </tr>
    <tr>
      <td><pre><textarea name="p1" cols="50" rows="20" id="p1" onKeyDown="javascript:if(event.keyCode == 27) 
        {
        p();return false
        }"></textarea><pre/><input type="button" name="button12" id="button12" onClick="QR();" value="QR_COD"><input type="button" name="button2" id="button2" onClick="corte();" value="corte"><input type="button" name="button9" id="button9" onClick="infoma();" value="Procisa inf"> <input type="button" name="button7" id="button7" onClick="limp();" value="Limpar"><br><select id="mods" name="mods" class="form-control search-select" size="1">	
        <option value="TEVO0001">EMTA 1.0</option>
	<option value="DECODER HD">DECODER HD</option>
	<option value="EMTA 3.0">EMTA 3.0</option>
    <option value="CARD0008">SMARTCARD PRETO</option>
    <option value="CARD0002">SMARTCARD LARANJA</option>

</select><input type="button" name="button10" id="button10" onClick="GenerateTxtFile();" value="Salvar"><input name="file" type="text" id="file" " onKeyDown="javascript:if(event.keyCode == 13) 
        {
        GenerateTxtFile();return false
        }" value="Procisa.txt" size="15" maxlength="12" >
      Digite 12 caracteres e precione enter.</td>
      <td>&nbsp;</td>
      <td rowspan="2">&nbsp;</td>
    </tr>
    <tr>
      <td colspan="2">MAC ID:
        <input name="campo2" type="text" id="campo2" " onKeyDown="javascript:if(event.keyCode == 13) 
        {
        test();return false
        }" value="123456789123" size="18" maxlength="12" >
        <span style="color: #FFF">
        <input name="act" type="checkbox" class="campos_v" id="act" value="on" />
        <strong>selecionar barcod 128</strong></span></td>
    </tr>
  </table>
<script>

function limp(){ 
document.getElementById('p1').value='';

}

function info(){ 

var e = document.getElementById("tecnicoSelecionado");
var itemSelecionado = e.options[e.selectedIndex].text;

var checkBox = document.getElementById("on");
RE = document.form1.tecnicoSelecionado.value;
  if (checkBox.checked == true){
document.form1.p1.value = document.form1.p1.value + "-----------------------------------------------\n";	  
        vo();
    } else {

document.getElementById('p1').value='';
document.form1.p1.value = document.form1.p1.value + "-----------------------------------------------\n\r";

document.form1.p1.value = document.form1.p1.value + "         COMPROVANTE DE CARGA DO TECNICO      \n\r";

document.form1.p1.value = document.form1.p1.value + "-----------------------------------------------\n";
document.form1.p1.value = document.form1.p1.value + document.form1.tecnicoSelecionado.value + "\n";
document.form1.p1.value = document.form1.p1.value + itemSelecionado + "\n";
document.form1.p1.value = document.form1.p1.value + "================================================";
	}



}

function infoma(){ 

var e = document.getElementById("tecnicoSelecionado");
var itemSelecionado = e.options[e.selectedIndex].text;


document.form1.p1.value = document.form1.p1.value + "\n\r\n\r\n\rAss:------------------------------------\n\r";
document.form1.p1.value = document.form1.p1.value + itemSelecionado + "\n\r";
document.form1.p1.value = document.form1.p1.value + "Tecnico";



}

function GenerateTxtFile(){

    var fso  = new ActiveXObject("Scripting.FileSystemObject"); 
	 
    var file = fso.CreateTextFile(document.form1.file.value, true);

    file.writeline(document.form1.p1.value);
    file.Close();
}

function p(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();

Imp.Imprimir(1,1,document.form1.p1.value) ;

Imp.Fechar();

}
function test(){ 
noStringAtAll = document.form1.campo2.value;
document.form1.p1.value = document.form1.p1.value + "\n" + document.form1.mods.value + "\n" + ModeloNet + noStringAtAll + "\n\r------------------------------------------------";
document.getElementById('campo2').value='';

var checkBox = document.getElementById("act");

if (checkBox.checked == true){
codbar();
Cen();
 
    } 
}

function codbar(){

Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.Code();
Imp.Fechar();

}

function QR(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.QR_Cods();
Imp.Fechar();

}

function logonet(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.mundonets();
Imp.Fechar();

}

function Cen(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.ImprimirCentering();
Imp.Fechar();

}

function negrito(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.impressao_b();
Imp.Fechar();

}
function normal(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.tamanhoG();
Imp.ImprimirCentering();
Imp.Fechar();

}



function vgraln(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.GRALN();

Imp.Fechar();

}

function vgral(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.GRAL();

Imp.Fechar();

}

function vo(){
// Obtém a data/hora atual
var data = new Date();
var e = document.getElementById("tecnicoSelecionado");
var itemSelecionado = e.options[e.selectedIndex].text;

// Guarda cada pedaço em uma variável
var dia     = data.getDate();           // 1-31
var dia_sem = data.getDay();            // 0-6 (zero=domingo)
var mes     = data.getMonth();          // 0-11 (zero=janeiro)
var ano2    = data.getYear();           // 2 dígitos
var ano4    = data.getFullYear();       // 4 dígitos
var hora    = data.getHours();          // 0-23
var min     = data.getMinutes();        // 0-59
var seg     = data.getSeconds();        // 0-59
var mseg    = data.getMilliseconds();   // 0-999
var tz      = data.getTimezoneOffset(); // em minutos

// Formata a data e a hora (note o mês + 1)
var str_data = '\n\rD:' + dia + '/' + (mes+1) + '/' + ano4;
var str_hora =  'Hora ' + hora + ':' + min;

var campo = document.form1.campo.value;
document.form1.p1.value = document.form1.p1.value + str_data + "\n" + str_hora+ "\n";
document.form1.p1.value = document.form1.p1.value + itemSelecionado + "\n"; 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.tamanhoP();
Imp.ffs();
Imp.NCOMP();
Imp.Imprimir(1,2,"SENHA\n \r") ;
Imp.Imprimir(1,3,campo + "\n \r") ;
//Imp.mundonets();
Imp.ImprimirCentering();
Imp.COMPN();
Imp.Imprimir(1,1,str_data + "\n \r" + str_hora+ "\n \r") ;

Imp.ImprimirCentering();
Imp.Imprimir(1,1,itemSelecionado + "\n \r");

Imp.ImprimirCentering();
Imp.QR_REs();
Imp.invertidaON();
Imp.Imprimir(1,1,RE );
Imp.invertidaOFF();
Imp.cortapapel(); 
Imp.Fechar();

document.form1.campo.value = parseInt(campo)+ parseInt(1);
}

function corte(){ 
Imp = new Impr(); 
Imp.Porta = "LPT5" ; 
Imp.Abrir();
Imp.cortapapel();
Imp.Fechar();

}

ob_start();
</script>
</form>

</body>

</html>